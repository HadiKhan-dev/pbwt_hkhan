use ndarray::{arr1,arr2,ArrayBase,OwnedRepr,Dim,array};



const mean_0dot1: [f64; 10] = [0.00012415, 0.00012421, 0.00012423, 0.00012426, 0.00012435,
0.00012448, 0.0001246 , 0.00012469, 0.00012472, 0.00012478];

const pca_components_0dot1: [[f64; 10] ; 10] = [[ 4.17138967e-01,  4.13438965e-01,  3.80968055e-01,
3.48603553e-01,  3.22282744e-01,  2.99970985e-01,
2.72983249e-01,  2.41409300e-01,  2.01178810e-01,
1.45884307e-01],
[ 4.69751601e-01,  3.69681823e-01,  2.09986895e-01,
2.81560847e-02, -1.41616724e-01, -2.78752715e-01,
-3.67326235e-01, -3.98913743e-01, -3.70381770e-01,
-2.62258948e-01],
[-3.76788048e-01, -1.70819219e-01,  1.39149228e-01,
3.87542188e-01,  4.51206369e-01,  2.98813598e-01,
1.43334578e-02, -2.68317463e-01, -4.17226099e-01,
-3.46620868e-01],
[-3.64672269e-01,  2.70406363e-04,  3.72276211e-01,
3.89534892e-01,  2.94446885e-02, -3.74941665e-01,
-4.28657007e-01, -9.67459513e-02,  3.05587577e-01,
3.85679189e-01],
[-3.73318088e-01,  2.26191953e-01,  4.42017867e-01,
-1.23928670e-02, -4.23439622e-01, -1.99899028e-01,
3.24724808e-01,  3.55954136e-01, -1.18212545e-01,
-3.85425661e-01],
[ 2.62665059e-01, -2.92591547e-01, -2.28997809e-01,
3.51269157e-01,  2.03758347e-01, -4.04439594e-01,
-1.52837609e-01,  4.66636155e-01,  1.34298014e-01,
-4.53137721e-01],
[-2.75177334e-01,  4.85081613e-01, -1.01700148e-01,
-3.86355187e-01,  3.45130232e-01,  1.45430123e-01,
-4.15873441e-01,  1.36004856e-01,  3.03021358e-01,
-3.25307904e-01],
[ 1.73960097e-01, -4.05363813e-01,  3.61691897e-01,
-3.45552072e-02, -3.17436931e-01,  4.36547398e-01,
-2.22303645e-01, -1.58265708e-01,  4.40669568e-01,
-3.36758852e-01],
[ 1.05936024e-01, -2.98291501e-01,  4.10144340e-01,
-3.80212312e-01,  1.99305503e-01,  6.60941890e-02,
-3.19119133e-01,  4.54886081e-01, -4.24120217e-01,
2.33007521e-01],
[-6.93323040e-02,  1.94550428e-01, -3.09216172e-01,
3.96468182e-01, -4.37266527e-01,  4.27575156e-01,
-3.91901926e-01,  3.26061321e-01, -2.38711779e-01,
1.16758532e-01]];


const mean_0dot2: [f64; 10] =  [0.0013971 , 0.00139589, 0.00139478, 0.00139366, 0.00139227,
0.00139078, 0.00138994, 0.00138957, 0.0013892 , 0.00138902];

const pca_components_0dot2: [[f64; 10]; 10] = [[ 0.48864614,  0.44247485,  0.39704831,  0.34926607,  0.30367501,
0.26168769,  0.22397331,  0.1894239 ,  0.15581367,  0.12159153],
[-0.41882126, -0.30417225, -0.15550617,  0.01008543,  0.17039029,
0.29966781,  0.3851004 ,  0.41783821,  0.39713156,  0.32915937],
[ 0.38683365,  0.15169184, -0.13923237, -0.35852056, -0.4266162 ,
-0.31550606, -0.07508181,  0.19846702,  0.39939027,  0.43970694],
[ 0.34823978,  0.00776343, -0.33811167, -0.39361345, -0.10201109,
0.28612097,  0.4461459 ,  0.23130241, -0.20702358, -0.47089333],
[ 0.3379849 , -0.17286105, -0.45715651, -0.08714177,  0.41087288,
0.32683055, -0.20202661, -0.43054608, -0.03286712,  0.3693235 ],
[ 0.29105495, -0.34743632, -0.27751937,  0.37391238,  0.26222456,
-0.36173437, -0.25795816,  0.36686275,  0.23597288, -0.34831048],
[ 0.24239226, -0.42257391,  0.01762518,  0.42091821, -0.31979091,
-0.18530067,  0.45910285, -0.11895813, -0.36454047,  0.30129009],
[ 0.17837276, -0.41986514,  0.32907337,  0.02937318, -0.37571918,
0.4373416 , -0.15042548, -0.2532175 ,  0.44716414, -0.2522084 ],
[-0.14352621,  0.37684305, -0.44363769,  0.3577989 , -0.16495138,
-0.08314041,  0.3035902 , -0.42761186,  0.40610516, -0.19619759],
[ 0.06917438, -0.20289281,  0.30502773, -0.37547812,  0.4220458 ,
-0.43603116,  0.40487377, -0.3399406 ,  0.24719811, -0.10577602]];



const mean_0dot3: [f64; 10] = [0.00239196, 0.00239039, 0.0023886 , 0.00238681, 0.00238509,
0.00238316, 0.00238108, 0.00237894, 0.002377  , 0.00237557];

const pca_components_0dot3: [[f64; 10]; 10] = [[ 0.45750234,  0.42157015,  0.38914779,  0.35468045,  0.31902175,
0.28171722,  0.24486523,  0.20844569,  0.17488614,  0.14353669],
[-0.40216597, -0.30846207, -0.1858879 , -0.04435567,  0.10042832,
0.23432987,  0.34187367,  0.41103144,  0.43513988,  0.40795152],
[ 0.3773799 ,  0.21044022, -0.04804809, -0.2960086 , -0.42652024,
-0.385583  , -0.1839802 ,  0.10431184,  0.36434511,  0.46400304],
[ 0.39512359,  0.04101375, -0.36052158, -0.45217866, -0.16428397,
0.25889466,  0.44399305,  0.24782511, -0.1480021 , -0.36508419],
[ 0.33482805, -0.16652957, -0.44403803, -0.08780448,  0.40598816,
0.31966821, -0.22471455, -0.4382919 , -0.03851263,  0.37971686],
[ 0.30034972, -0.31948684, -0.30383253,  0.33365742,  0.27249627,
-0.3583409 , -0.25947325,  0.39437502,  0.24169717, -0.34661038],
[ 0.26866664, -0.46135511,  0.03754124,  0.41443037, -0.31135153,
-0.18523631,  0.41806523, -0.08769672, -0.37349981,  0.29763098],
[ 0.17814991, -0.39756718,  0.28911421,  0.05282792, -0.3863116 ,
0.442035  , -0.16225565, -0.24256706,  0.47112313, -0.26846015],
[ 0.12850593, -0.3525209 ,  0.44640245, -0.36751038,  0.14459702,
0.12914691, -0.34899293,  0.43956598, -0.37947399,  0.16814924],
[-0.08753967,  0.23702197, -0.32858752,  0.38923467, -0.41601106,
0.41598305, -0.38917911,  0.3285211 , -0.24506281,  0.10552077]];


const mean_0dot5: [f64; 10] =   [0.00388261, 0.00388141, 0.00387993, 0.00387855, 0.00387711,
       0.00387556, 0.00387395, 0.00387219, 0.00387054, 0.00386896];

const pca_components_0dot5: [[f64; 10]; 10] = [[ 0.41450134,  0.38876276,  0.36825426,  0.34663758,  0.32355934,
0.29979349,  0.27521949,  0.24982677,  0.22359455,  0.19637427],
[-0.40516163, -0.33520308, -0.23436312, -0.10886501,  0.02900749,
0.16687608,  0.29022689,  0.38592875,  0.44394622,  0.44469689],
[ 0.43192704,  0.24462315, -0.0479854 , -0.31345908, -0.44638291,
-0.39693612, -0.1921728 ,  0.08468399,  0.31713715,  0.38928863],
[ 0.36529561,  0.02979625, -0.34803076, -0.43360757, -0.14138988,
0.276799  ,  0.46206729,  0.25559105, -0.15709239, -0.3954878 ],
[ 0.33971367, -0.13922533, -0.44232263, -0.11422093,  0.39301254,
0.32926516, -0.22209842, -0.45261144, -0.03937772,  0.37135613],
[ 0.31101055, -0.33397207, -0.31322397,  0.34254136,  0.28269956,
-0.35239533, -0.25319695,  0.37522467,  0.23732374, -0.333114  ],
[ 0.2635692 , -0.42739317,  0.01337169,  0.39992889, -0.28826538,
-0.20415097,  0.42947876, -0.09303883, -0.40598716,  0.32409271],
[-0.20137585,  0.45041906, -0.32965065, -0.04036685,  0.37058497,
-0.40365947,  0.11732859,  0.25752452, -0.45104142,  0.24994795],
[-0.13177596,  0.34746711, -0.43766761,  0.37373942, -0.16494675,
-0.10593112,  0.3395221 , -0.43897582,  0.39080925, -0.17757218],
[ 0.06717182, -0.19641138,  0.30310867, -0.38740666,  0.43954937,
-0.44683584,  0.40330677, -0.3206585 ,  0.22089423, -0.08839301]];

const mean_0dot7: [f64; 10] =  [0.00587891, 0.00587713, 0.00587516, 0.00587308, 0.00587108,
0.00586874, 0.0058664 , 0.00586393, 0.00586149, 0.00585889];

const pca_components_0dot7: [[f64; 10]; 10] = 
[[ 0.38559029,  0.36697274,  0.35281694,  0.33834272,  0.32315544,
0.30728495,  0.29057946,  0.27298226,  0.25445607,  0.23481576],
[-0.4345149 , -0.36722381, -0.26246177, -0.13082271,  0.0126852 ,
0.15483567,  0.27983613,  0.37234286,  0.42215377,  0.41357761],
[-0.41451074, -0.23608212,  0.04801896,  0.31400269,  0.44612116,
0.39982344,  0.19485513, -0.08528248, -0.32396571, -0.4030686 ],
[-0.37647848, -0.04460726,  0.34158653,  0.43114895,  0.14767125,
-0.26441709, -0.45999291, -0.25927429,  0.15500658,  0.39891916],
[ 0.34243459, -0.14188022, -0.44922446, -0.11625524,  0.38857538,
0.32852182, -0.21236766, -0.44868019, -0.04804115,  0.37369957],
[ 0.30970916, -0.32052518, -0.31313737,  0.33836336,  0.28950309,
-0.3532231 , -0.26143638,  0.3734877 ,  0.24397836, -0.33593599],
[ 0.26532755, -0.43190354,  0.01039968,  0.40930819, -0.29164303,
-0.21309415,  0.43247864, -0.09085858, -0.39220618,  0.3095735 ],
[ 0.20022242, -0.43174072,  0.30560864,  0.05534621, -0.37775765,
0.41035218, -0.11742315, -0.26628584,  0.46358441, -0.25759366],
[ 0.14647386, -0.37919191,  0.46188527, -0.38702519,  0.17250366,
0.09367147, -0.31564071,  0.4134123 , -0.36806042,  0.16460039],
[-0.06195324,  0.18209749, -0.28451087,  0.3681475 , -0.4269214 ,
0.44335222, -0.41688042,  0.3485184 , -0.24903699,  0.1021099 ]];


const mean_1: [f64; 10] = [0.00837114, 0.00836931, 0.00836737, 0.00836528, 0.00836308,
0.00836107, 0.00835903, 0.00835683, 0.00835464, 0.00835234];

const pca_components_1: [[f64; 10]; 10] = 
[[ 0.36839303,  0.35337842,  0.34285587,  0.33241838,  0.32159875,
0.31036473,  0.29839743,  0.285882  ,  0.27255787,  0.25797049],
[-0.44330722, -0.38173813, -0.27939347, -0.14769018, -0.00266005,
0.14017178,  0.26582961,  0.36138796,  0.41439768,  0.40649024],
[ 0.41152074,  0.23992722, -0.0458933 , -0.31133523, -0.45051928,
-0.40716949, -0.19915789,  0.08505485,  0.32166297,  0.39361138],
[ 0.37597991,  0.05433225, -0.33800374, -0.43590009, -0.14893611,
0.27228643,  0.46258717,  0.25354745, -0.16071364, -0.38859716],
[ 0.35244177, -0.1459427 , -0.45709851, -0.10769005,  0.39256594,
0.31235182, -0.22456222, -0.44185287, -0.03833259,  0.36762223],
[-0.30918668,  0.31801694,  0.30553234, -0.33914585, -0.27722281,
0.35895468,  0.24191423, -0.38704004, -0.23876319,  0.35194829],
[ 0.26043036, -0.42050118,  0.00398886,  0.40795746, -0.29182422,
-0.21638423,  0.43753214, -0.09491858, -0.39641521,  0.31517797],
[-0.21252761,  0.45176015, -0.32432199, -0.04057484,  0.36984993,
-0.40605411,  0.11683881,  0.25576833, -0.44791795,  0.2500911 ],
[-0.14270622,  0.36452265, -0.44486876,  0.38003859, -0.17737249,
-0.08243647,  0.31620286, -0.42628653,  0.39024168, -0.17936231],
[ 0.06234133, -0.18073002,  0.28746908, -0.37633115,  0.43248784,
-0.44630566,  0.4154783 , -0.33906998,  0.23695886, -0.09597903]];

const mean_2: [f64; 10] = [0.01431992, 0.01431625, 0.01431275, 0.0143093 , 0.01430584,
0.01430226, 0.01429862, 0.01429484, 0.01429097, 0.01428726];

const pca_components_2: [[f64; 10]; 10] = 
[[ 0.35265523,  0.34120452,  0.33374706,  0.32666285,  0.31959206,
0.3122451 ,  0.30462902,  0.29657913,  0.28811359,  0.27877321],
[-0.4517053 , -0.39465955, -0.29300001, -0.16153276, -0.01617293,
0.1276922 ,  0.2550063 ,  0.35145223,  0.40544093,  0.39845731],
[ 0.4055117 ,  0.24146824, -0.04059363, -0.30985941, -0.45329835,
-0.41123502, -0.20517608,  0.07950706,  0.3185735 ,  0.39381638],
[ 0.37817251,  0.06229501, -0.33132426, -0.4374204 , -0.15525042,
0.26930251,  0.46319837,  0.25780542, -0.15753144, -0.38669557],
[ 0.35638584, -0.14468874, -0.45851116, -0.11183571,  0.38522208,
0.31419509, -0.21889899, -0.44363682, -0.04297204,  0.36827027],
[ 0.3119578 , -0.30934157, -0.31141128,  0.33437397,  0.27949475,
-0.35347988, -0.24828187,  0.38820151,  0.24267678, -0.35200218],
[-0.26192795,  0.41941884,  0.0011088 , -0.41383811,  0.29285549,
0.22162732, -0.43484416,  0.08674694,  0.39640238, -0.30916994],
[ 0.21024681, -0.441258  ,  0.30885936,  0.06007094, -0.38516302,
0.41541083, -0.12131504, -0.25292559,  0.44708386, -0.25019125],
[-0.14208445,  0.35888287, -0.42755316,  0.35012719, -0.14050091,
-0.11958307,  0.34696202, -0.44514692,  0.39997249, -0.18184419],
[ 0.08255865, -0.22269037,  0.32547469, -0.39758819,  0.43318414,
-0.43000942,  0.38958043, -0.31396009,  0.22038047, -0.09008287]];




const mean_3: [f64; 10] =  [0.02446069, 0.02445653, 0.02445273, 0.02444856, 0.0244444 ,
0.02444002, 0.02443553, 0.02443097, 0.02442648, 0.02442205];

const pca_components_3: [[f64; 10]; 10] = 
[[ 0.34348983,  0.33438774,  0.32884242,  0.32366539,  0.31854222,
0.31334624,  0.30787821,  0.30221731,  0.29616795,  0.28949644],
[-0.45364272, -0.40017367, -0.30070146, -0.17072142, -0.02609542,
0.11963166,  0.2479965 ,  0.34658295,  0.4019165 ,  0.39541189],
[ 0.40000554,  0.24609754, -0.03273985, -0.30507795, -0.45321175,
-0.41719664, -0.21176957,  0.07341081,  0.31742656,  0.39349468],
[ 0.3894767 ,  0.06623862, -0.33751749, -0.44034141, -0.15446933,
0.26764636,  0.45828866,  0.25386471, -0.15421403, -0.37729117],
[ 0.34314047, -0.13120965, -0.44934998, -0.11863518,  0.38286875,
0.31686883, -0.22408051, -0.45436655, -0.04213778,  0.37896962],
[-0.31845795,  0.30699688,  0.3211312 , -0.32904516, -0.29133914,
0.34958205,  0.2551017 , -0.38014964, -0.24280914,  0.34250325],
[-0.26543305,  0.41584828,  0.0129033 , -0.4160656 ,  0.28649444,
0.22637936, -0.43646554,  0.0942246 ,  0.39245105, -0.31082707],
[ 0.21596805, -0.44441449,  0.30650084,  0.05926014, -0.37693904,
0.4024166 , -0.10723748, -0.2652703 ,  0.45615369, -0.25383551],
[-0.15338287,  0.37940734, -0.44583202,  0.36522011, -0.15331395,
-0.10121064,  0.32403321, -0.424     ,  0.38741018, -0.17822154],
[-0.0688653 ,  0.19299558, -0.29754873,  0.38310402, -0.43526311,
0.44246015, -0.40809971,  0.32973201, -0.23085394,  0.09444186]];
   
const mean_5: [f64; 10] = 
[0.03883546, 0.03883068, 0.03882593, 0.03882086, 0.0388158 ,
0.03881066, 0.0388053 , 0.03880018, 0.03879521, 0.03879018];

const pca_components_5: [[f64; 10]; 10] = 
[[ 0.33742667,  0.32986731,  0.32554638,  0.32159021,  0.31773452,
0.31390067,  0.30997964,  0.30585784,  0.3014559 ,  0.29652855],
[-0.4537132 , -0.40467802, -0.3068002 , -0.17735885, -0.03136586,
0.11466203,  0.24498133,  0.3441573 ,  0.39901394,  0.39114458],
[-0.40235625, -0.24773527,  0.03366924,  0.3066462 ,  0.45449763,
0.41773432,  0.21112678, -0.07448293, -0.31575419, -0.38817288],
[ 0.38377348,  0.07140952, -0.32899376, -0.43754453, -0.15715134,
0.26761637,  0.46195271,  0.25724712, -0.15708579, -0.38388683],
[ 0.34627762, -0.12542153, -0.4539714 , -0.12658412,  0.37968068,
0.32201366, -0.22083229, -0.45275838, -0.04081034,  0.3727934 ],
[ 0.32197756, -0.306801  , -0.32375039,  0.32998832,  0.29205884,
-0.34876146, -0.25169986,  0.38000724,  0.23811705, -0.34220755],
[-0.26773612,  0.41584538,  0.01342457, -0.41167425,  0.28578362,
0.22193632, -0.43369541,  0.09481988,  0.39744496, -0.31584975],
[ 0.21725901, -0.44418427,  0.30326034,  0.06620639, -0.38556564,
0.41238989, -0.11936564, -0.25201964,  0.44691188, -0.25085887],
[-0.14883738,  0.3664897 , -0.43214884,  0.35684506, -0.14628556,
-0.11259217,  0.33852625, -0.43584901,  0.39678359, -0.18265722],
[-0.08062581,  0.21575915, -0.31736204,  0.39183322, -0.43082238,
0.42996861, -0.39605851,  0.3231381 , -0.22812367,  0.09430603]];

const mean_7: [f64; 10] = 
[0.05969927, 0.05969424, 0.05968934, 0.05968475, 0.05968006,
0.05967503, 0.05966994, 0.05966455, 0.05965905, 0.05965381];
const pca_components_7: [[f64; 10]; 10] = 
[[ 0.33314322,  0.32687856,  0.32340443,  0.32030275,  0.31730939,
0.31434717,  0.31131539,  0.30818101,  0.30485831,  0.30108293],
[ 0.45519643,  0.40787634,  0.30970396,  0.18054698,  0.03481661,
-0.11195398, -0.24230481, -0.34208249, -0.39735511, -0.38800815],
[-0.40068734, -0.24954732,  0.03247155,  0.30689472,  0.45503404,
0.4188168 ,  0.2120064 , -0.07532433, -0.31628958, -0.38576414],
[-0.38213162, -0.0752466 ,  0.3260072 ,  0.43972193,  0.15793468,
-0.26938787, -0.46352483, -0.2558583 ,  0.15900358,  0.3815275 ],
[ 0.34885189, -0.12559015, -0.45661998, -0.12606616,  0.38008627,
0.31817904, -0.22189704, -0.4497762 , -0.04065277,  0.37315137],
[-0.31992412,  0.29971213,  0.32346385, -0.32327262, -0.29356953,
0.34663706,  0.25188702, -0.3842037 , -0.24195474,  0.35035008],
[ 0.27277618, -0.41945529, -0.01674336,  0.41512683, -0.28564919,
-0.2249214 ,  0.42880789, -0.08805261, -0.3946781 ,  0.3121769 ],
[ 0.22102979, -0.44773178,  0.30783003,  0.05830863, -0.3777571 ,
0.40830135, -0.11662901, -0.25482156,  0.44843156, -0.25196273],
[-0.14798827,  0.36500221, -0.43257221,  0.35952912, -0.15086005,
-0.1080067 ,  0.33724525, -0.43582902,  0.39632919, -0.18251201],
[-0.077629  ,  0.20884932, -0.31123766,  0.38971779, -0.4340506 ,
0.43625062, -0.40083771,  0.32298834, -0.22297052,  0.09046624]];


const mean_10: [f64; 10] = [0.08500153, 0.08499866, 0.08499575, 0.08499248, 0.08498937,
0.08498608, 0.08498289, 0.08497974, 0.08497629, 0.08497253];

const pca_components_10: [[f64; 10]; 10] = 
[[ 0.33053184,  0.32490743,  0.32196656,  0.31941388,  0.31700077,
0.31463507,  0.31220431,  0.30969727,  0.30700708,  0.3039312 ],
[-0.45434383, -0.4104848 , -0.31342242, -0.18321505, -0.03659744,
0.11082386,  0.24210914,  0.34205694,  0.3961176 ,  0.38356526],
[-0.39497492, -0.25098952,  0.02800624,  0.30398772,  0.45680765,
0.4219183 ,  0.21361955, -0.07563278, -0.3186731 , -0.38498277],
[ 0.38590995,  0.08093148, -0.32540012, -0.44282245, -0.15961172,
0.26884782,  0.46181917,  0.25239216, -0.16135956, -0.37653147],
[-0.34824338,  0.12213784,  0.45503168,  0.12843046, -0.37839499,
-0.31520027,  0.22512337,  0.45171271,  0.03659333, -0.37638109],
[-0.3239243 ,  0.29739474,  0.32578375, -0.32050202, -0.2953555 ,
0.347622  ,  0.24975397, -0.38575106, -0.23676655,  0.34993937],
[-0.27263157,  0.41619431,  0.01913848, -0.41205286,  0.28134364,
0.22924079, -0.43166406,  0.09108361,  0.39558575, -0.31539932],
[ 0.22634579, -0.45298057,  0.30761198,  0.05953167, -0.37587978,
0.40384475, -0.11246306, -0.25409038,  0.44683817, -0.25329161],
[-0.15095114,  0.37171915, -0.44303353,  0.37346312, -0.1653297 ,
-0.09168821,  0.32195974, -0.42304264,  0.38953908, -0.18215581],
[ 0.06958216, -0.19090897,  0.2949158 , -0.37932118,  0.43108074,
-0.44066737,  0.41146558, -0.33614143,  0.23655326, -0.09788479]];


const mean_20: [f64; 10] = [0.14713019, 0.14713567, 0.1471413 , 0.1471468 , 0.14715245,
0.14715811, 0.14716341, 0.14716856, 0.1471737 , 0.14717911];

const pca_components_20: [[f64; 10]; 10] =
[[ 0.32762286,  0.32286341,  0.32055256,  0.31855902,  0.31672565,
0.31491681,  0.3131113 ,  0.31122186,  0.30921991,  0.30689781],
[-0.45271363, -0.41250896, -0.31700827, -0.18741744, -0.03931699,
0.10914645,  0.24193336,  0.34201872,  0.39528484,  0.37953887],
[ 0.39512893,  0.25403432, -0.02719731, -0.30631332, -0.45962219,
-0.42180384, -0.210962  ,  0.0789007 ,  0.31883066,  0.37844132],
[-0.38341426, -0.08445335,  0.32189711,  0.44031819,  0.15821479,
-0.27140633, -0.4637912 , -0.25062023,  0.16677294,  0.37939949],
[-0.34939694,  0.11738423,  0.45577477,  0.13403919, -0.37632153,
-0.31598302,  0.22853351,  0.45084816,  0.03118794, -0.37485743],
[ 0.32566041, -0.29374003, -0.32960138,  0.32201061,  0.29329321,
-0.34531747, -0.24895513,  0.38692973,  0.2342889 , -0.3514037 ],
[-0.27896508,  0.42176332,  0.02007292, -0.41322018,  0.28741442,
0.22073644, -0.42805791,  0.09957819,  0.38664929, -0.31489945],
[ 0.21967737, -0.43779182,  0.29685601,  0.06518448, -0.38209674,
0.41520879, -0.12371298, -0.248465  ,  0.45202684, -0.26065954],
[ 0.15363523, -0.37199566,  0.43474896, -0.35847827,  0.14668227,
0.10850302, -0.33565765,  0.43152106, -0.39320155,  0.18365615],
[ 0.08224288, -0.21433797,  0.31383688, -0.38797287,  0.42906305,
-0.43052216,  0.3980095 , -0.32601926,  0.23317242, -0.09881737]];

const mean_30: [f64; 10] = 
[0.24716798, 0.24718369, 0.2471989 , 0.24721463, 0.24723056,
0.24724626, 0.24726215, 0.24727785, 0.24729344, 0.24730889];

const pca_components_30: [[f64; 10]; 10] = 
[[ 0.32561232,  0.32153275,  0.31964742,  0.31803447,  0.31658412,
0.31515725,  0.31370691,  0.31221034,  0.3106291 ,  0.30878077],
[-0.45256047, -0.41447728, -0.31890268, -0.18907509, -0.04054526,
0.10876985,  0.24161728,  0.34146378,  0.39446742,  0.37668759],
[ 0.39350527,  0.25521548, -0.0263662 , -0.30634346, -0.46127425,
-0.42321309, -0.20952041,  0.08215433,  0.31985641,  0.37501689],
[ 0.38208846,  0.08747815, -0.32055474, -0.4398844 , -0.15794284,
0.2726224 ,  0.46485542,  0.24933678, -0.16953116, -0.37925354],
[ 0.35524268, -0.11912081, -0.46009908, -0.13130734,  0.37598485,
0.30976608, -0.23033211, -0.44774864, -0.02677128,  0.37297725],
[ 0.3189857 , -0.28442272, -0.32705932,  0.31710175,  0.29592626,
-0.34784547, -0.24845619,  0.39437003,  0.23470114, -0.35905275],
[ 0.28203291, -0.42302348, -0.02491627,  0.41843647, -0.28646355,
-0.22619125,  0.42784032, -0.09777757, -0.38008857,  0.30903027],
[-0.22336134,  0.44011918, -0.29704625, -0.06352874,  0.37770679,
-0.41156803,  0.12416881,  0.2458935 , -0.45392717,  0.26485921],
[ 0.15713217, -0.37609609,  0.43621272, -0.36105909,  0.15081945,
0.10186764, -0.32869034,  0.42704264, -0.39382927,  0.18597911],
[ 0.07908886, -0.20700201,  0.30802322, -0.38532622,  0.42895625,
-0.43305138,  0.40240996, -0.32956483,  0.23544865, -0.10010363]];

const mean_50: [f64; 10] =  [0.39248339, 0.39251484, 0.39254639, 0.39257762, 0.39260907,
0.39264043, 0.39267155, 0.39270238, 0.39273305, 0.39276351];


const pca_components_50: [[f64; 10]; 10] = 
[[ 0.32468518,  0.32093934,  0.31924986,  0.31782211,  0.31651701,
         0.31524338,  0.31396621,  0.31266171,  0.31126681,  0.30962162],
       [ 0.45234626,  0.415668  ,  0.31998463,  0.18955027,  0.04086008,
        -0.10868641, -0.24152476, -0.34151527, -0.39418902, -0.37476574],
       [-0.39184321, -0.25545456,  0.02594212,  0.30578036,  0.46094021,
         0.42359065,  0.21040187, -0.08151233, -0.32109978, -0.37565151],
       [-0.38172069, -0.09032055,  0.31817527,  0.44172154,  0.16069915,
        -0.27319667, -0.46622056, -0.24702751,  0.17134418,  0.37626378],
       [ 0.35218133, -0.11542019, -0.45824589, -0.13508082,  0.37516651,
         0.31298344, -0.2305352 , -0.44992923, -0.02588397,  0.37342877],
       [-0.32960566,  0.29264978,  0.33027098, -0.32048701, -0.2912934 ,
         0.34665026,  0.24104775, -0.39063178, -0.22828507,  0.35509978],
       [ 0.27565531, -0.41326193, -0.02559016,  0.41315116, -0.2865592 ,
        -0.22372003,  0.4313363 , -0.10393472, -0.38796537,  0.31991031],
       [-0.22538356,  0.44277635, -0.29811472, -0.06633525,  0.38088168,
        -0.40866111,  0.11613717,  0.25053966, -0.45057283,  0.26178236],
       [ 0.15863671, -0.37836993,  0.43808171, -0.36224105,  0.15063337,
         0.10120761, -0.32698336,  0.42446278, -0.39223173,  0.18620026],
       [-0.0780373 ,  0.20454189, -0.30540108,  0.3836257 , -0.42939277,
         0.43511017, -0.40466405,  0.33041251, -0.23473668,  0.09954178]];

const mean_70: [f64; 10] = [0.59202262, 0.5920766 , 0.59213058, 0.59218435, 0.59223775,
0.59229076, 0.59234343, 0.59239616, 0.59244881, 0.59250116];


const pca_components_70: [[f64; 10]; 10] = 
[[-0.32431441, -0.32075638, -0.31914257, -0.31776509, -0.31651717,
-0.31529652, -0.31406925, -0.31279828, -0.31145524, -0.30988261],
[-0.45255057, -0.41579529, -0.31994745, -0.18968046, -0.04125668,
 0.10819515,  0.24135202,  0.34130575,  0.39383168,  0.37512011],
[ 0.39154692,  0.2558632 , -0.02546994, -0.30577033, -0.46075594,
-0.42356448, -0.21109331,  0.08162297,  0.32109674,  0.37556904],
[ 0.38281466,  0.08976133, -0.31964253, -0.44108542, -0.15970644,
 0.27259825,  0.46442557,  0.24865622, -0.16950016, -0.3776253 ],
[ 0.35307189, -0.11616855, -0.4592347 , -0.13449502,  0.37691367,
 0.31144305, -0.23227548, -0.4475693 , -0.02559748,  0.37265747],
[ 0.32332808, -0.28692363, -0.32866456,  0.31916669,  0.2935743 ,
-0.34734019, -0.24572192,  0.39302304,  0.23194683, -0.35744822],
[ 0.28088357, -0.41756487, -0.02772114,  0.41467472, -0.2842704 ,
-0.22619486,  0.42922846, -0.10095868, -0.38470677,  0.31562257],
[-0.22563891,  0.44261545, -0.29661329, -0.06709193,  0.38102489,
-0.41163015,  0.12195962,  0.24627957, -0.44958597,  0.2615783 ],
[ 0.15679671, -0.37479488,  0.43463903, -0.35894881,  0.14847985,
 0.10315377, -0.33035926,  0.42917786, -0.39537686,  0.186675  ],
[-0.08104053,  0.21010993, -0.31046046,  0.38695976, -0.42898359,
 0.43160057, -0.40034809,  0.32764322, -0.23485006,  0.10036685]];


const mean_90: [f64; 10] = [0.78906242, 0.78913866, 0.78921457, 0.78929049, 0.78936582,
       0.78944147, 0.78951651, 0.78959161, 0.78966643, 0.78974157];

const pca_components_90: [[f64; 10]; 10] = 
[[-0.32588731, -0.32176279, -0.31981025, -0.31814148, -0.31660433,
-0.31511054, -0.3136187 , -0.31206465, -0.31040267, -0.30846354],
[ 0.45468815,  0.41489427,  0.31781475,  0.1871705 ,  0.03898905,
-0.10966964, -0.24204829, -0.34155904, -0.39386697, -0.37570426],
[-0.39665424, -0.25345028,  0.03118274,  0.31076028,  0.46155957,
 0.41964006,  0.2059567 , -0.08435397, -0.31970853, -0.37416807],
[ 0.38162781,  0.08223947, -0.32377527, -0.43669677, -0.15157323,
 0.27613245,  0.46436213,  0.24932713, -0.17071623, -0.38196673],
[-0.35047643,  0.11911171,  0.45734515,  0.13151097, -0.37835484,
-0.31165162,  0.23198483,  0.44967204,  0.02556693, -0.37358301],
[ 0.32167649, -0.29204983, -0.32421306,  0.32162519,  0.29456117,
-0.34821541, -0.24873956,  0.39080666,  0.23317822, -0.35451475],
[ 0.28038832, -0.42203142, -0.02156906,  0.41200552, -0.28360081,
-0.22516914,  0.43015512, -0.10161927, -0.38418254,  0.31459721],
[ 0.22436585, -0.44591896,  0.30520565,  0.05903973, -0.37818268,
 0.41430179, -0.12720022, -0.24082005,  0.44511816, -0.25924425],
[-0.15257584,  0.3712716 , -0.4393367 ,  0.37194535, -0.16619479,
-0.08819641,  0.31943707, -0.42316498,  0.39479611, -0.18747268],
[-0.07439929,  0.19761966, -0.30000209,  0.37968631, -0.42572166,
 0.43338733, -0.40750938,  0.33815576, -0.24605953,  0.10595402]];

const mean_100: [f64; 10] = [0.95049019, 0.95056959, 0.95065103, 0.95073233, 0.95081364,
0.95089396, 0.95097336, 0.95105394, 0.95113387, 0.95121339];
 
 const pca_components_100: [[f64; 10]; 10] = 
 [[-0.33439857, -0.32770185, -0.32394323, -0.32053243, -0.31733194,
 -0.31414086, -0.31095384, -0.3075568 , -0.30399695, -0.30004529],
[-0.45795551, -0.40688522, -0.30818201, -0.17840988, -0.03247524,
  0.11427709,  0.24439698,  0.34248079,  0.39630836,  0.38693377],
[ 0.40007987,  0.24927285, -0.03507926, -0.31119407, -0.45839649,
 -0.41645736, -0.20621884,  0.08039059,  0.31782356,  0.38231151],
[ 0.38598817,  0.06718415, -0.33371301, -0.43496233, -0.14862805,
  0.27425642,  0.4614482 ,  0.25194105, -0.16      , -0.38291932],
[ 0.34624321, -0.126694  , -0.45526844, -0.12049104,  0.38122189,
  0.31237555, -0.22907265, -0.45229637, -0.03196024,  0.37589955],
[-0.3162769 ,  0.30267901,  0.31934404, -0.33021295, -0.28998725,
  0.3513859 ,  0.25161557, -0.38416177, -0.24198114,  0.34687598],
[-0.27543926,  0.42723582,  0.00917295, -0.41526593,  0.29577671,
  0.21319125, -0.4255027 ,  0.09698222,  0.38576556, -0.31123191],
[-0.20833403,  0.42823616, -0.2959902 , -0.0650687 ,  0.38519391,
 -0.42238022,  0.13199826,  0.24909643, -0.4563318 ,  0.25860376],
[-0.1508429 ,  0.36718266, -0.42827313,  0.35217862, -0.13911585,
 -0.12187662,  0.34689592, -0.43769896,  0.39440468, -0.18247279],
[-0.0863985 ,  0.22803408, -0.32730342,  0.39386129, -0.42590374,
  0.42407893, -0.39181581,  0.32092295, -0.22743914,  0.09383414]];




fn pca_transform(data: &Vec<f64>, transform_index: usize) -> Vec<f64>{
    let mean_vec: ArrayBase<OwnedRepr<f64>, Dim<[usize; 1]>>;
    let pca_component_matrix: ArrayBase<OwnedRepr<f64>, Dim<[usize; 2]>>;

    match transform_index {
        0 => {
            mean_vec = arr1(&mean_0dot1);
            pca_component_matrix = arr2(&pca_components_0dot1);
        }
        1 => {
            mean_vec = arr1(&mean_0dot2);
            pca_component_matrix = arr2(&pca_components_0dot2);
        }
        2 => {
            mean_vec = arr1(&mean_0dot3);
            pca_component_matrix = arr2(&pca_components_0dot3);
        }
        3 => {
            mean_vec = arr1(&mean_0dot5);
            pca_component_matrix = arr2(&pca_components_0dot5);
        }
        4 => {
            mean_vec = arr1(&mean_0dot7);
            pca_component_matrix = arr2(&pca_components_0dot7);
        }
        5 => {
            mean_vec = arr1(&mean_1);
            pca_component_matrix = arr2(&pca_components_1);
        }
        6 => {
            mean_vec = arr1(&mean_2);
            pca_component_matrix = arr2(&pca_components_2);
        }
        7 => {
            mean_vec = arr1(&mean_3);
            pca_component_matrix = arr2(&pca_components_3);
        }
        8 => {
            mean_vec = arr1(&mean_5);
            pca_component_matrix = arr2(&pca_components_5);
        }
        9 => {
            mean_vec = arr1(&mean_7);
            pca_component_matrix = arr2(&pca_components_7);
        }
        10 => {
            mean_vec = arr1(&mean_10);
            pca_component_matrix = arr2(&pca_components_10);
        }
        11 => {
            mean_vec = arr1(&mean_20);
            pca_component_matrix = arr2(&pca_components_20);
        }
        12 => {
            mean_vec = arr1(&mean_30);
            pca_component_matrix = arr2(&pca_components_30);
        }
        13 => {
            mean_vec = arr1(&mean_50);
            pca_component_matrix = arr2(&pca_components_50);
        }
        14 => {
            mean_vec = arr1(&mean_70);
            pca_component_matrix = arr2(&pca_components_70);
        }
        15 => {
            mean_vec = arr1(&mean_90);
            pca_component_matrix = arr2(&pca_components_90);
        }
        16 => {
            mean_vec = arr1(&mean_100);
            pca_component_matrix = arr2(&pca_components_100);
        }
        _ => {
            mean_vec = arr1(&mean_70);
            pca_component_matrix = arr2(&pca_components_70);
        }
    }

    let mut demeaned : Vec<f64> = Vec::new();

    for i in (0..mean_vec.len()) {
        demeaned.push(data[i]-mean_vec[i]);
    }

    let demeaned_array = arr1(&demeaned);

    let transformed = pca_component_matrix.dot(&demeaned_array);

    return transformed.to_vec();
}

pub fn get_probability(data: &Vec<f64>, transform_index: usize) -> f64 {

    let transformed_data = pca_transform(data,transform_index);

    let intercept: f64;
    let coefficients: [f64; 10];

    match transform_index {
        0 => {
            intercept = -9.47841741;
            coefficients = [17.14528396,  6.08966869, -5.84448655, -3.73750521, -9.83857997,
            0.61291846, -7.27774402,  7.38852039, -5.18774286, -6.68892604];
        }
        1 => {

            intercept = -8.36389731;
            coefficients = [11.91884245, -5.66538112,  8.09584963,  3.2053121 ,  4.65997534,
            3.38396568,  3.27381214,  2.75751578, -3.06770695,  1.83038249];
        }
        2 => {

            intercept = -8.3579218;
            coefficients = [10.11160016, -6.07569314,  6.07212653,  4.77274572,  4.5169964 ,
            3.59978037,  3.83524858,  2.82683992,  2.52882284, -3.43702036];
        }
        3 => {

            intercept = -8.1669745;
            coefficients = [ 8.73403041, -5.88067586,  6.38362936,  4.41135497,  4.46212473,
            4.25835519,  4.01427938, -2.68754547, -1.43393741,  1.43232803];
        }
        4 => {

            intercept = -8.06321695;
            coefficients = [ 7.81971834, -6.46876   , -6.25923993, -4.67817198,  4.34017854,
            3.80841852,  4.29772345,  2.98541467,  2.74935129, -0.95746362];
        }
        5 => {

            intercept = -7.84793716;
            coefficients = [ 7.31964766, -6.23791971,  5.61164697,  4.59061523,  4.77438102,
            -3.82664978,  3.61453057, -3.26837616, -2.31047565,  0.71619007];
        }
        6 => {
            intercept = -7.52640158;
            coefficients = [ 6.65461905, -6.2067662 ,  5.18865369,  4.13729272,  4.29227432,
            3.66251584, -3.18017812,  2.86042496, -1.98832341,  1.57521698];
        }
        7 => {
            intercept = -7.18601715;
            coefficients = [ 6.2024824 , -5.95069901,  4.74561363,  4.17047436,  3.72838951,
            -3.29981829, -3.30324893,  2.8010377 , -2.3060283 , -0.93860753];
        }
        8 => {
            intercept = -6.83471888;
            coefficients = [ 5.87009564, -5.63298315, -4.56806369,  3.88218007,  3.54062381,
            3.21656532, -2.95409154,  2.5022004 , -2.13884427, -1.18355305];
        }
        9 => {
            intercept = -6.38936822;
            coefficients = [ 5.60963573,  5.35474019, -4.31097311, -3.62212872,  3.34229051,
            -3.06962991,  2.91060148,  2.56348285, -1.79137704, -1.02212164];
        }
        10 => {

            intercept = -5.84614621;
            coefficients = [ 5.39571854, -5.06342102, -4.00240241,  3.41969062, -3.28257121,
            -2.97974769, -2.85797353,  2.53099834, -1.84019417,  0.70405761];
        }
        11 => {
            intercept = -4.75889376;
            coefficients = [ 5.02815343, -4.64116302,  3.63921267, -3.12141395, -2.94018189,
            2.72804368, -2.62432646,  2.07967104,  1.63134811,  0.94652913];
        }
        12 => {
            intercept = -3.27822936;
            coefficients = [ 4.79486331, -4.28973649,  3.33079397,  2.84093953,  2.78908172,
            2.41431936,  2.44253604, -1.97388741,  1.56407326,  0.76826047];
        }
        13 => {
            intercept = -1.36185641;
            coefficients = [ 4.66647307,  4.09861979, -3.2022815 , -2.73698809,  2.65070247,
            -2.44136093,  2.29757156, -1.90237913,  1.58942081, -0.71917893];
        }
        14 => {
            intercept = 1.19001937;
            coefficients = [-4.69402381, -4.16570383,  3.22312222,  2.76515374,  2.6451679 ,
            2.38753023,  2.38000928, -1.93626981,  1.50189506, -0.79295806];
        }
        15 => {
            intercept = 3.7561344;
            coefficients = [-4.82233084,  4.42267266, -3.42787648,  2.9173601 , -2.778355  ,
            2.5441647 ,  2.46235448,  2.08429828, -1.53215221, -0.78646089];
        }
        16 => {
            intercept = 6.41629607;
            coefficients = [-5.5494105 , -5.52373032,  4.18568878,  3.78733211,  3.42566403,
            -3.05955337, -2.89078822, -2.38443152, -1.92588901, -1.3827943 ];
        }
        _ => {      
            intercept = 3.72923862;
            coefficients = [-12.45419914,-10.89681354,-9.83674778, -6.43013269,   6.24992008,
            -3.78126667,  -3.84896225,  -2.07388275,   0.4100299,    0.01495938];
        }
    }

    let mut expo: f64 = intercept;

    for i in (0..coefficients.len()) {
        expo += coefficients[i]*transformed_data[i];
    }

    let prob: f64 = 1.0/(1.0+(-expo).exp());

    return prob;

}